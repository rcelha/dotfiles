#!/bin/sh

BASE=${PWD}
LN='ln -s --backup -S .old'

create_home_link () {
    target=`realpath ${1}`
    linkname=${HOME}/.`basename ${target}`
    echo installing $target
    ${LN} ${target} ${linkname}
}

install_home () {
    for i in ${BASE}/home/*; do
        create_home_link $i
    done;
}

install_sources () {
    create_home_link "${BASE}/sources"
}

install_non_links () {
    for i in vim byobu; do
        target=`realpath ${i}`
        dirname=${HOME}/.${i}
        mkdir -p ${dirname}

        for ii in ${i}/*; do
            origin=`realpath ${ii}`
            linkname=${dirname}/.`basename ${ii}`
            ${LN} ${origin} ${linkname} 
        done;
    done;
}

install_sources
install_home
install_non_links
